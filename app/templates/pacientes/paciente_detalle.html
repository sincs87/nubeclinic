{% extends 'components/sidebar.html' %}

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ficha del paciente - NubeClinic</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/panel.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/pacientes.css') }}">
  <style>
    body {
      background-color: #f5f6fa;
      font-family: 'Poppins', sans-serif;
    }
    .tab-header .nav-link {
      color: #555;
      border: none;
    }
    .tab-header .nav-link.active {
      font-weight: 600;
      color: #1a73e8;
      border-bottom: 3px solid #1a73e8;
    }
    .form-section-title {
      font-size: 16px;
      font-weight: 600;
      margin: 40px 0 20px;
    }
    .form-check-label {
      font-weight: 400;
    }
    .form-control, .form-select {
      border-radius: 8px;
    }
    .sidebar-container {
      min-width: 250px;
    }
  </style>
</head>
<body>
  <div class="d-flex">
    {% include 'components/sidebar.html' %}

    <div class="flex-grow-1 p-5" style="max-width: 1600px; margin: auto;">
      <form method="POST">
        <ul class="nav nav-tabs tab-header mb-4">
          <li class="nav-item">
            <a class="nav-link active" href="#">Datos del paciente</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="#">Historial clínico</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="#">Citas</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="#">Lista de pagos</a>
          </li>
        </ul>

        <div class="row">
          <!-- Sidebar paciente -->
          <div class="col-md-3">
            <div class="bg-white rounded shadow-sm p-4 text-center">
              <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center mx-auto" style="width: 80px; height: 80px; font-size: 24px;">
                {{ paciente.nombre[0] }}{{ paciente.apellidos[0] }}
              </div>
              <h5 class="mt-3">{{ paciente.nombre }} {{ paciente.apellidos }}</h5>
              <p class="text-muted small">Nº {{ paciente.id|string|slice(0, 5) }}</p>

              <div class="d-flex justify-content-around mb-3">
                <i class="fas fa-calendar-plus text-muted"></i>
                <i class="fas fa-notes-medical text-muted"></i>
                <i class="fas fa-user-circle text-muted"></i>
                <i class="fas fa-ellipsis-h text-muted"></i>
              </div>

              {% if paciente.email %}
                <p class="small"><i class="fas fa-envelope me-2"></i>{{ paciente.email }}</p>
              {% endif %}
              {% if paciente.telefono %}
                <p class="small"><i class="fas fa-phone me-2"></i>{{ paciente.telefono }}</p>
              {% endif %}

              <div class="mt-3 text-start">
                <label class="fw-bold">Notas</label>
                <textarea class="form-control mt-2" rows="4" name="notas">{{ paciente.notas or '' }}</textarea>
              </div>

              <div class="mt-4 text-start">
                <label class="fw-bold">Otra información médica</label>
                <ul class="list-unstyled mt-2 small text-muted ps-2">
                  <li>Alergias</li>
                  <li>Medicación</li>
                  <li>Antecedentes médicos</li>
                  <li>Otros</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Formulario principal -->
          <div class="col-md-9">
            <!-- Datos generales -->
            <div class="bg-white rounded shadow-sm p-4">
              <div class="form-section-title">Datos generales del paciente</div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label>Nombre*</label>
                  <input type="text" class="form-control" name="nombre" value="{{ paciente.nombre }}" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label>Apellidos*</label>
                  <input type="text" class="form-control" name="apellidos" value="{{ paciente.apellidos }}" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label>Fecha de nacimiento</label>
                  <input type="date" class="form-control" name="fecha_nacimiento" value="{{ paciente.fecha_nacimiento }}">
                </div>
                <div class="col-md-6 mb-3">
                  <label>Género</label>
                  <select class="form-select" name="genero">
                    <option value="">Selecciona una opción</option>
                    <option value="Hombre" {% if paciente.genero == 'Hombre' %}selected{% endif %}>Hombre</option>
                    <option value="Mujer" {% if paciente.genero == 'Mujer' %}selected{% endif %}>Mujer</option>
                    <option value="Otro" {% if paciente.genero == 'Otro' %}selected{% endif %}>Otro</option>
                  </select>
                </div>
                <div class="col-md-12 mb-3">
                  <label>Tipo de paciente</label><br>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="tipo_paciente" value="Privado" {% if paciente.tipo_paciente == 'Privado' %}checked{% endif %}>
                    <label class="form-check-label">Privado</label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="tipo_paciente" value="De aseguradora" {% if paciente.tipo_paciente == 'De aseguradora' %}checked{% endif %}>
                    <label class="form-check-label">De aseguradora</label>
                  </div>
                </div>
              </div>

              <div class="form-section-title">Datos administrativos y contacto</div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label>Estado del paciente</label>
                  <select class="form-select" name="estado">
                    <option value="Activo" {% if paciente.estado == 'Activo' %}selected{% endif %}>Activo</option>
                    <option value="Inactivo" {% if paciente.estado == 'Inactivo' %}selected{% endif %}>Inactivo</option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label>Número de documento</label>
                  <input type="text" class="form-control" name="dni" value="{{ paciente.dni }}">
                </div>
                <div class="col-md-6 mb-3">
                  <label>Teléfono</label>
                  <input type="text" class="form-control" name="telefono" value="{{ paciente.telefono }}">
                </div>
                <div class="col-md-6 mb-3">
                  <label>Email</label>
                  <input type="email" class="form-control" name="email" value="{{ paciente.email }}">
                </div>
                <div class="col-md-6 mb-3">
                  <label>Ciudad</label>
                  <input type="text" class="form-control" name="ciudad" value="{{ paciente.ciudad }}">
                </div>
                <div class="col-md-6 mb-3">
                  <label>Provincia</label>
                  <input type="text" class="form-control" name="provincia" value="{{ paciente.provincia }}">
                </div>
                <div class="col-md-6 mb-3">
                  <label>Nacionalidad</label>
                  <input type="text" class="form-control" name="nacionalidad" value="{{ paciente.nacionalidad }}">
                </div>
              </div>

              <div class="text-end">
                <button type="submit" class="btn btn-primary">Guardar cambios</button>
              </div>
            </div>

          </div>
        </div>
      </form>
    </div>
  </div>
</body>
</html>